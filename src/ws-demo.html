<html>
    <head>
        <title>Websockets demo</title>

        <script src="http://autobahn.s3.amazonaws.com/js/autobahn.min.js"></script>
        <script>
            // WAMP session object
            var sess;
            var wsuri = "ws://ec2-54-226-58-190.compute-1.amazonaws.com:9000";

            window.onload = function() {

                // connect to WAMP server
                ab.connect(wsuri,

                    // WAMP session was established
                    function(session) {
    
                        sess = session;
                        console.log("Connected to " + wsuri);
    
                        // subscribe to topic, providing an event handler
                        sess.subscribe("http://example.com/simple", onEvent);
                    },
    
                    // WAMP session is gone
                    function(code, reason) {
    
                        sess = null;
                        console.log("Connection lost (" + reason + ")");
                });
            };

            function onEvent(topic, event) {
                console.log(topic);
                console.log(event);
            }

            function publishEvent() {
                sess.publish("http://example.com/simple", {
                    a : "foo",
                    b : "bar",
                    c : 23
                });
            }

            function callProcedure() {
                // issue an RPC, returns promise object
                sess.call("http://example.com/simple/calc#add", 23, 7).then(

                // RPC success callback
                function(res) {
                    console.log("got result: " + res);
                },

                // RPC error callback
                function(error, desc) {
                    console.log("error: " + desc);
                });
            }
        </script>
    </head>
    <body>
        <h1>AutobahnJS WAMP Client</h1>
        <button onclick="publishEvent();">
            Publish Event
        </button>
        <button onclick="callProcedure();">
            Call Procedure
        </button>
        <p>
            Go <a href="http://autobahn.ws/js/getstarted">here</a> for an explanation of what's going on.
        </p>
    </body>
</html>

</html>